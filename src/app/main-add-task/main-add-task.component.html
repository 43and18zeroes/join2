<div class="addtask__container">

    <h2>Add Task</h2>

    <form [formGroup]="addTaskForm" (ngSubmit)="onSubmit()">

        <div class="form__body">

            <div class="form__left">

                <label for="addTaskTitle">Title<span class="asterisk">*</span></label>
                <input id="addTaskTitle" formControlName="title" required placeholder="Enter a Title" />
                <div class="input__required">
                    <!-- <span>This field is required</span> -->
                </div>

                <label for="addTaskDescription">Description</label>
                <textarea id="addTaskDescription" formControlName="description"
                    placeholder="Enter a Description"></textarea>

                <label for="addTaskAssignedTo">Assigned to</label>
                <div class="assign__select no__select" #assignSelectRef>
                    <div class="header" (click)="assignToggleDropdown()" tabindex="0" #assignSelectedOptionRef>
                        <span>Select a contact to assign</span>
                        <span class="material__symbols__outlined">
                            arrow_drop_down
                        </span>
                    </div>
                    <div class="options" *ngIf="showAssignedDropdown">
                        <div class="options__body">
                            <div class="option__container" (click)="assignSelectOption(currentUserData)"
                                (mousedown)="assignPreventFocusLoss($event)"
                                [class.selected]="currentUserData.selected">
                                <div class="option__left">
                                    <span class="initials"
                                        [ngStyle]="{'background-color': currentUserData.userColor}">{{
                                        currentUserData.userInitials }}</span><span class="name">{{
                                        currentUserData.userName }} (You)</span>
                                </div>
                                <input type="checkbox" [checked]="currentUserData.selected" readonly />
                            </div>
                            <ng-container *ngFor="let user of allUsersData">
                                <div *ngIf="user.userEmailAddress !== currentUserData.userEmailAddress"
                                    class="option__container" (click)="assignSelectOption(user)"
                                    (mousedown)="assignPreventFocusLoss($event)" [class.selected]="user.selected">
                                    <div class="option__left"><span class="initials"
                                            [ngStyle]="{'background-color': user.userColor}">{{ user.userInitials
                                            }}</span><span class="name">{{ user.userName }}</span></div>
                                    <input type="checkbox" [checked]="user.selected" readonly />
                                </div>
                            </ng-container>
                        </div>
                        <button class="btn__primary">Add new contact<span
                                class="material__symbols__outlined">person_add</span></button>
                    </div>
                </div>


            </div>

            <hr>

            <div class="form__right">

                <label for="addTaskDueDate">Due date<span class="asterisk">*</span></label>
                <input id="addTaskDueDate" formControlName="dueDate" type="date" [min]="today"
                    class="inputs__right input__date">
                <div class="input__required">
                    <!-- <span>This field is required</span> -->
                </div>

                <label for="addTaskPrio">Prio</label>
                <div class="prio__container">
                    <button id="addTaskPrioHigh" type="button" (click)="setPriority('urgent')"
                        [class.btn__red]="selectedPriority === 'urgent'">
                        Urgent<div class="material__symbols__outlined red">keyboard_double_arrow_up</div>
                    </button>
                    <button id="addTaskPrioMiddle" type="button" (click)="setPriority('medium')"
                        [class.btn__yellow]="selectedPriority === 'medium'">
                        Medium<div class="material__symbols__outlined yellow">double_arrow</div>
                    </button>
                    <button id="addTaskPrioLow" type="button" (click)="setPriority('low')"
                        [class.btn__green]="selectedPriority === 'low'">
                        Low<div class="material__symbols__outlined green">keyboard_double_arrow_down</div>
                    </button>
                </div>

                <!-- <label for="addTaskCategory">Category<span class="asterisk">*</span></label>
                <select id="addTaskCategory" formControlName="category">
                    <option value="">Select a task category</option>
                    <option value="category0">Category 0</option>
                    <option value="category1">Category 1</option>
                    <option value="category2">Category 2</option>
                </select> -->

                <!-- <label for="addTaskCategory">Category<span class="asterisk">*</span></label>
                <div class="select">
                    <select id="addTaskCategory" formControlName="category">
                        <option value="">Select a task category</option>
                        <option value="Technical Task">Technical Task</option>
                        <option value="User Story">User Story</option>
                    </select>
                    <div class="select_arrow">
                    </div>
                </div> -->

                <label for="addTaskCategory">Category<span class="asterisk">*</span></label>
                <div class="category__select no__select" #categorySelectRef>
                    <div class="header" (click)="categoryToggleDropdown()" tabindex="0" #categorySelect>
                        <span>{{ addTaskForm.controls['category'].value || 'Select a task category' }}</span>
                        <span class="material__symbols__outlined">
                            arrow_drop_down
                        </span>
                    </div>
                    <div class="options" *ngIf="showCategoryDropdown">
                        <div class="option" (mousedown)="categoryPreventFocusLoss($event)" (click)="selectCategory('Technical Task')">Technical Task</div>
                        <div class="option" (mousedown)="categoryPreventFocusLoss($event)" (click)="selectCategory('User Story')">User Story</div>
                    </div>
                </div>

                <div class="input__required">
                    <!-- <span>This field is required</span> -->
                </div>

                <label for="subTask">Subtasks</label>
                <div class="subtask__container" (click)="focusSubTaskInput()">
                    <input id="subTask" formControlName="subTask" class="inputs__right" #subTaskInput (blur)="onSubTaskBlur()">
                    <div *ngIf="!subTaskInputHasFocus" class="material__symbols__outlined add__symbol">add</div>
                    <div *ngIf="subTaskInputHasFocus" class="handler__symbols">
                        <div class="material__symbols__outlined">clear</div>
                        <hr>
                        <div class="material__symbols__outlined">check</div>
                    </div>
                </div>

            </div>

        </div>

        <div class="form__footer">
            <span><span class="asterisk">*</span>This field is required</span>
            <div class="footer__right">
                <button class="btn__secondary btn__secondary__main">Clear <span class="material__symbols__outlined">
                        close
                    </span></button>
                <button type="submit" class="btn__primary">Create Task <span class="material__symbols__outlined">
                        check
                    </span></button>
            </div>
        </div>
    </form>
</div>